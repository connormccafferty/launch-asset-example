<!DOCTYPE html>
<html>
  <head>
    <title>launch asset example</title>
    <script src="https://openfin.github.io/excel-api-example/client/fin.desktop.Excel.js"></script>
    <script src="main.js"></script>
  </head>
  <body>
    <p>Version: <span id="of-version"></span></p>
    <button onclick="openWorkbookFromAsset('example', 'file_example.xltm')">
      launch file_example.xltm
    </button>
  </body>
  <script>
    function openWorkbookFromAsset(alias, fileName) {
      // Note for the workbookOpened to fire Excel must be launched w/ fin.desktop.Excel.run
      // once we launch Excel we can launchExternalProcess on our asset to trigger the event
      fin.desktop.Excel.run();
      return new Promise((resolve, reject) => {
        fin.System.launchExternalProcess({
          alias,
          target: fileName,
        })
          .then(resolve)
          .catch((err) => reject(err));
      });
    }

    const ofVersion = document.getElementById("of-version");

    if (typeof fin !== "undefined") {
      fin.System.getVersion()
        .then((v) => (ofVersion.textContent = v))
        .catch(console.error);

      (async () => {
        await fin.System.deleteCacheOnExit();
      })();
    } else {
      ofVersion.textContent = "You are probably running in a browser.";
    }
  </script>
</html>
